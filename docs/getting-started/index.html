



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.2.0">
    
    
      
        <title>Getting Started - PyGaSe API Reference</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.750b69bd.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#getting-started" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="PyGaSe API Reference" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              PyGaSe API Reference
            </span>
            <span class="md-header-nav__topic">
              Getting Started
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/sbischoff-ai/pygase/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="PyGaSe API Reference" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    PyGaSe API Reference
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/sbischoff-ai/pygase/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Getting Started
      </label>
    
    <a href="./" title="Getting Started" class="md-nav__link md-nav__link--active">
      Getting Started
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#backend" title="Backend" class="md-nav__link">
    Backend
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client" title="Client" class="md-nav__link">
    Client
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events" title="Events" class="md-nav__link">
    Events
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conclusion" title="Conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../api/main/" title="API" class="md-nav__link">
      API
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Low Level API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Low Level API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/client/" title="pygase.client" class="md-nav__link">
      pygase.client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/backend/" title="pygase.backend" class="md-nav__link">
      pygase.backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/gamestate/" title="pygase.gamestate" class="md-nav__link">
      pygase.gamestate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/connection/" title="pygase.connection" class="md-nav__link">
      pygase.connection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/event/" title="pygase.event" class="md-nav__link">
      pygase.event
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/utils/" title="pygase.utils" class="md-nav__link">
      pygase.utils
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#backend" title="Backend" class="md-nav__link">
    Backend
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client" title="Client" class="md-nav__link">
    Client
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events" title="Events" class="md-nav__link">
    Events
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conclusion" title="Conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/sbischoff-ai/pygase/edit/master/docs/getting-started.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="getting-started">Getting Started</h1>
<p>This little starter guide demonstrates the basics of setting up und running a backend,
connecting a client and communicating via events.</p>
<h2 id="backend">Backend</h2>
<p>To set up a simple PyGaSe backend you will need two classes:</p>
<pre><code class="python">from pygase import GameState, Backend
</code></pre>

<p>First you define your initial game state:</p>
<pre><code class="python">initial_game_state = GameState(position=0, hp=100)
</code></pre>

<p>The <code>GameState</code> constructor takes arbitrary keyword arguments to initialize game state attributes.
(Use only built-in types such as <code>int</code>, <code>str</code> or <code>dict</code>.) In this case my game state only consists of the attributes
<code>position</code> initialized with a value of <code>0</code> and <code>hp</code> with 100.</p>
<p><em>TL;DR: Put stuff like empty lists of enemies and players or other game world objects here.</em></p>
<p>Next you define a time step function for your game loop:</p>
<pre><code class="python">import math

def time_step(game_state, dt):
    new_position = game_state.position += math.sin(dt)
    return {&quot;position&quot;: new_position}
</code></pre>

<p>The <code>time_step</code> function represents one iteration of the game loop and takes the current <code>game_state</code> as an argument,
in order to return a <code>dict</code> containing all the changes to the game state. By default it will be called 50 times per
seconds or once every 0.02 seconds respectively. However, the actual interval may turn out somewhat longer and differ
from time to time, which is why the time step function also gets the time since the last time step in seconds (<code>dt</code>).
In this example my game loop will have the <code>position</code> continously oscillating between -1 and 1.</p>
<p><em>TL;DR: Use this to simulate your game world, like the movement of enemies and bullets or something.</em></p>
<p>Now you can initialize and run your backend:</p>
<pre><code class="python">backend = Backend(initial_game_state, time_step)
backend.run('localhost', 8080)
</code></pre>

<p>That <code>run</code> call is blocking, so whatever you put after there will not be executed until the backend is shut down again.</p>
<p>Now this first super simple PyGaSe backend looks like this:</p>
<pre><code class="python"># backend.py

import math
from pygase import GameState, Backend

initial_game_state = GameState(position=0, hp=100)

def time_step(game_state, dt):
    new_position = game_state.position += math.sin(dt)
    return {&quot;position&quot;: new_position}

backend = Backend(initial_game_state, time_step)
backend.run('localhost', 8080)
</code></pre>

<h2 id="client">Client</h2>
<p>If you run <code>python backend.py</code> it starts a server that just sits there until you terminate the python process.
To interact with it we can just connect a client in an interactive python session in another console window:</p>
<pre><code class="python">&gt;&gt;&gt; from pygase import Client
&gt;&gt;&gt; client = Client()
&gt;&gt;&gt; client.connect_in_thread(8080)
&lt;Thread(Thread-1, started 24096)&gt;
&gt;&gt;&gt; with client.acces_game_state() as game_state:
...   print(game_state.position)
...   print(game_state.hp)
... 
0.7904802223420048
100
&gt;&gt;&gt; with client.acces_game_state() as game_state:
...   print(game_state.position)
... 
-0.29265129683264307
&gt;&gt;&gt; 
</code></pre>

<p>This is a rather one-sided kind of interaction of course. To have the client talk to the backend you
use events.</p>
<h2 id="events">Events</h2>
<p>First you need to register an event handler on the backend side or the event will do nothing:</p>
<pre><code class="python">def on_attack(attack_position, client_address, game_state, dt):
    if abs(attack_position - game_state.position) &lt; 0.1:
        print(&quot;Hit!&quot;)
        return {&quot;hp&quot;: game_state.hp - 10}
    print(&quot;Missed.&quot;)
    return {}

backend = Backend(
    initial_game_state,
    time_step, 
    event_handlers={&quot;ATTACK&quot;: on_attack}
)
backend.run('localhost', 8080)
</code></pre>

<p>The event handler function <code>on_attack</code> works similar to the time step function, only that it also has the argument
<code>client_address</code> which identifies the sender of the event and can have further additional arguments,
like <code>attack_position</code> in this case, which represent data that comes with an event.</p>
<p>Having extended the backend like this we can now run it again and try out the event in a client terminal session again:</p>
<pre><code class="python">&gt;&gt;&gt; client.dispatch_event(&quot;ATTACK&quot;, attack_position=0.5)
&gt;&gt;&gt; with client.acces_game_state() as game_state:
...   print(game_state.position)
...   print(game_state.hp)
... 
-0.1760756199485871
100
&gt;&gt;&gt; client.dispatch_event(&quot;ATTACK&quot;, attack_position=0.5)
&gt;&gt;&gt; with client.acces_game_state() as game_state:
...   print(game_state.hp)
... 
100
&gt;&gt;&gt; client.dispatch_event(&quot;ATTACK&quot;, attack_position=0.5)
&gt;&gt;&gt; client.dispatch_event(&quot;ATTACK&quot;, attack_position=0.5)
&gt;&gt;&gt; with client.acces_game_state() as game_state:
...   print(game_state.hp)
... 
90
&gt;&gt;&gt; 
</code></pre>

<p>This is me trying repeadedly to land a hit on position 0.5. If you look at the console output
of the backend process, you might see something like this:</p>
<pre><code>Missed.
Missed.
Hit!
Missed.
</code></pre>

<p>It's not very practical to have to switch the console windows, it would be better if the client
received some feedback after an attack. Events can also flow from backend to client, which works pretty
much the same way as the other way around.</p>
<p>First we adjust the backends attack event handler to send back a feedback event:</p>
<pre><code class="python">def on_attack(attack_position, client_address, game_state, dt):
    if abs(attack_position - game_state.position) &lt; 0.1:
        backend.server.dispatch_event(&quot;ATTACK_FEEDBACK&quot;, &quot;Hit!&quot;, target_client=client_address)
        return {&quot;hp&quot;: game_state.hp - 10}
    backend.server.dispatch_event(&quot;ATTACK_FEEDBACK&quot;, &quot;Missed.&quot;, target_client=client_address)
    return {}
</code></pre>

<p>Now we only need to register an appropriate event handler on the client side:</p>
<pre><code class="python">&gt;&gt;&gt; client.register_event_handler(&quot;ATTACK_FEEDBACK&quot;, print)
&gt;&gt;&gt; client.dispatch_event(&quot;ATTACK&quot;, attack_position=0.5)
Missed.
&gt;&gt;&gt; client.dispatch_event(&quot;ATTACK&quot;, attack_position=0.5)
Missed.
&gt;&gt;&gt; for i in range(5):
...   client.dispatch_event(&quot;ATTACK&quot;, attack_position=i*2.0/5-1)
... 
Missed.
Hit!
Missed.
Missed.
Missed.
</code></pre>

<p>Much better. We even found an exploit that allows us to land a guaranteed hit using a for loop.
Passing the built-in function <code>print</code> as the event handler callback works in this case, because
the handler only gets one argument, the string that the backend attached to the event in
<code>backend.dispatch_event("ATTACK_FEEDBACK", "Hit!")</code> and <code>backend.dispatch_event("ATTACK_FEEDBACK", "Missed.")</code>.</p>
<h3 id="conclusion">Conclusion</h3>
<p>A proper client for this game, with a UI and such, would probably not allow to send attack events in such a way.
Still, this is how cheats and hacks find their way into an online game, which is why your backend should always
validate the events it gets. In this case for example it should check if <code>ATTACK</code> events are coming in in an
unreasonably high frequency.</p>
<p>Next you could try out to connect with a seconds client from another parallel terminal window and add some
additional functionality. You can also take a peek into
<a href="https://github.com/sbischoff-ai/pygase/tree/master/chase">this example game of chase</a>.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../api/main/" title="API" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                API
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.39abc4af.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>